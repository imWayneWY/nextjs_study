{"version":3,"file":"static/webpack/static/development/pages/_app.js.d9b9da2bc3be2d11d16c.hot-update.js","sources":["webpack:///./components/Layout.jsx"],"sourcesContent":["import { connect } from 'react-redux'\nimport Link from 'next/link'\nimport getConfig from 'next/config'\nimport { Button, Layout, Icon, Input, Avatar, Tooltip, Dropdown, Menu } from 'antd'\nimport { useState, useCallback } from 'react'\nconst { Header, Content, Footer } = Layout\nimport Container from './Container'\nimport { logout } from './../store/store'\nimport axios from 'axios'\nimport { withRouter } from 'next/router'\nconst { publicRuntimeConfig } = getConfig()\n\n// 写在外面是为了每次渲染时都是过来拿到这个对象，而不是定义新对象重复渲染\nconst githubIconStyle = {\n  color: 'white',\n  fontSize: 40,\n  display: 'block',\n  paddingTop: 10,\n  marginRight: 20,\n}\n\nconst footerStyle = {\n  textAlign: 'center',\n}\n\nconst Comp = ({children, color, style}) => {\n  return (\n    <div style={{color, ...style}}>{children}</div>\n  )\n}\n\nfunction MyLayout ({ children, user, logout, router, }) {\n  const urlQuery = router.query && router.query.query\n  const [search, setSearch] = useState(urlQuery || '')\n\n  const handleSearchChange = useCallback(\n    (event) => {\n      setSearch(event.target.value)\n    },\n    [setSearch],\n  )\n  const handleGotoOAuth = useCallback((e) => {\n    e.preventDefault()\n    axios.get(`/prepare-auth?url=${router.asPath}`)\n      .then(resp => {\n        if (resp.status === 200) {\n          location.href = publicRuntimeConfig.OAUTH_URL\n        } else {\n          console.log('prepare auth failed', resp)\n        }\n      }).catch(err => {\n        console.log('prepare auth failed', err)\n      })\n  }, [])\n  const handleLogout  = useCallback(() => {\n    logout()\n  }, [logout])\n\n  const userDropDown = (\n    <Menu>\n      <Menu.Item>\n        <a onClick={handleLogout}>Log Out</a>\n      </Menu.Item>\n    </Menu>\n  )\n\n  const handleOnSearch = useCallback(\n    () => {\n      router.push(`/search?query=${search}`)\n    },\n    [search],\n  )\n\n  return (\n    <Layout>\n      <Header>\n        <Container renderer={<div className=\"header-inner\"/>}>\n        {/* <div className=\"header-inner\"> */}\n          <div className=\"header-left\">\n            <div className=\"logo\">\n              <Link href='/'>\n                <Icon type=\"github\" style={githubIconStyle}></Icon>\n              </Link>\n            </div>\n            <div>\n              <Input.Search \n                placeholder=\"Search Repos\" \n                value={search} \n                onChange={handleSearchChange}\n                onSearch={handleOnSearch}\n              />\n            </div>\n          </div>\n          <div className=\"header-right\">\n            <div className=\"user\">\n              {\n                user && user.id\n                ?(\n                  <Dropdown overlay={userDropDown}>\n                  <a href=\"/\">\n                    <Avatar size={40} src={user.avatar_url} />\n                  </a>\n                  </Dropdown>\n                )\n                :(\n                  <Tooltip title=\"Click here to Login In\"> \n                    {/* <a href= {publicRuntimeConfig.OAUTH_URL} onClick={handleGotoOAuth}> */}\n                    <a href={`/prepare-auth?url=${router.asPath}`}>\n                      <Avatar size={40} icon=\"user\" />\n                    </a>\n                  </Tooltip>\n                )\n              }\n            </div>\n          </div>\n        {/* </div> */}\n        </Container>\n      </Header>\n      <Content>\n        <Container renderer={<Comp/>} >\n        {/* <Container render={<div />} > */}\n          {children}\n        </Container>\n      </Content>\n      <Footer style={footerStyle}>\n        Develop by Weiyan @\n        <a href=\"mailto: im.weiyan@foxmail.com\">im.weiyan@foxmail.com</a>\n      </Footer>\n      <style jsx>{`\n        .header-inner {\n          display: flex;\n          justify-content: space-between;\n        }\n        .header-left {\n          display: flex;\n          justify-content: space-start;\n        }\n      `}</style>\n      <style jsx global>{`\n        #__next {\n          height: 100%;\n        }\n        .ant-layout {\n          min-height: 100%;\n        }\n        .ant-layout-header{\n          padding-left: 0;\n          padding-right: 0;\n        }\n        .ant-layout {\n          background: #fff;\n        }\n      `}\n      </style>\n    </Layout>\n  )\n}\n\nexport default connect(\n  function mapState(state) {\n    return {\n      user: state.user,\n    }\n  },\n  function mapReducer(dispatch) {\n    return {\n      logout: () => dispatch(logout())\n    }\n  }\n)(withRouter(MyLayout))"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAQA;AACA;AADA;AACA;AAGA;AAAA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AAGA;AAEA;AACA;AAGA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AAAA;AAKA;AAEA;AACA;AAIA;AAGA;AAAA;AAAA;AAAA;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AAAA;AAGA;AAAA;AAEA;AACA;AACA;AACA;AAJA;AAQA;AAAA;AACA;AAAA;AAIA;AAAA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAKA;AAAA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAWA;AAAA;AAKA;AAAA;AAEA;AAAA;AAAA;AApDA;AAAA;AAAA;AAAA;AAkFA;AACA;AACA;AAEA;AACA;AADA;AAGA;AAEA;AACA;AAAA;AAAA;AADA;AAGA;;;;A","sourceRoot":""}