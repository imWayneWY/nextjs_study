{"version":3,"file":"static/webpack/static/development/pages/detail/issues.js.8cefa2afdbd981904513.hot-update.js","sources":["webpack:///./components/SearchUser.jsx"],"sourcesContent":["import { Select, Spin } from 'antd'\nimport { useState, useCallback, useRef } from 'react'\nimport debounce from 'lodash/debounce'\n\nimport api from '../lib/api'\n\nconst Option = Select.Option\n\nfunction SearchUser({ onChange, value }) {\n  // { current: 0 }\n  const lastFetchIdRef = useRef(0)\n  const [fetching, setFetching] = useState(false)\n  const [options, setOptions] = useState([])\n\n  const fetchUser = useCallback(debounce(value => {\n    console.log('fetching user', value)\n    if (value === '') {\n      return\n    }\n\n    lastFetchIdRef.current += 1\n    const fetchId = lastFetchIdRef.current\n\n    setFetching(true)\n    setOptions([])\n\n    api\n      .request({\n        url: `/search/users?q=${value}`\n      })\n      .then(resp => {\n        console.log('user:', resp)\n        if (fetchId !== lastFetchIdRef.current) {\n          return\n        }\n        const data = resp.data.items.map(user => ({\n          text: user.login,\n          value: user.login\n        }))\n\n        setFetching(false)\n        console.log(data)\n        setOptions(data)\n      })\n  }, 500))\n \n  const handleChange = (value) => {\n    setOptions([])\n    setFetching(false)\n    onChange(value)\n  }\n  return(\n    <Select\n      style={{width: 200}}\n      showSearch={true}\n      notFoundContent={fetching? <Spin size=\"small\"/> : <span>nothing</span>}\n      filterOption={false}\n      placeHolder=\"creator\"\n      value={value}\n      onChange={handleChange}\n      onSearch={fetchUser}\n      allowClear={true}\n    >\n      {\n        options.map(op => {\n          <Option value={op.value} key={op.value}>{op.text}</Option>\n        })\n      }\n    </Select>\n  )\n}\n\nexport default SearchUser"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;AACA;AACA;AAEA;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAKA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AAEA;AADA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAFA;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAEA;AAAA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAaA;AAAA;AAAA;AAAA;AACA;AAIA;AACA;AACA;;;;A","sourceRoot":""}